{"version":3,"sources":["webpack:///./src/views/Coupons.vue","webpack:///./src/components/CouponModal.vue","webpack:///./src/components/CouponModal.vue?27a9","webpack:///./src/views/Coupons.vue?86d8"],"names":["_createElementVNode","class","type","_createElementBlock","_createVNode","_component_Loading","actuve","$data","z-index","_hoisted_1","_hoisted_4","_Fragment","_renderList","item","key","_toDisplayString","title","percent","_ctx","date","due_date","is_enabled","_hoisted_7","id","ref","tabindex","aria-labelledby","aria-hidden","_hoisted_2","_hoisted_3","props","coupon","Object","default","isNew","Boolean","data","tempCoupon","due_data","emits","mixins","modalMixin","watch","this","__exports__","coupons","code","isLoading","components","CouponModal","DeleteProduct","methods","openCouponModal","Date","getTime","$refs","couponMosal","openModal","getCoupons","api","process","$http","get","then","response","catch","error","$httpMessageState","updateCoupons","apiMethods","couponComponent","couponModal","hideModal","delCoupon","delete","delComponentCoupon","deleteProduct","heidModal","created","render"],"mappings":"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","file":"assets/js/chunk-2d22c48a.ec52e786.js","sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <Loading :actuve=\"isLoading\" :z-index=\"1060\"></Loading>\r\n      <div class=\"text-end mt-4 mx-5\"> \r\n        <button type=\"button\" class=\"btn btn-secondary\">建立新的優惠券</button>\r\n      </div>\r\n      <div class=\"px-3\">\r\n        <table class=\"table table-hover mt-4\">\r\n          <thead>\r\n            <tr>\r\n              <th>名稱</th>\r\n              <th>折扣百分比</th>\r\n              <th>到期日</th>\r\n              <th>是否啟用</th>\r\n              <th>編輯</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(item, key) in coupons\" :key=\"key\">\r\n              <td>{{ item.title }}</td>\r\n              <td>{{ item.percent }}</td>\r\n              <td>{{ $filters.date(item.due_date) }}</td>\r\n              <td>\r\n                <span class=\"text-success\" v-if=\"item.is_enabled === 1\">啟用</span>\r\n                <span class=\"text-secondary\" v-else>不啟用</span>\r\n              </td>\r\n              <td>\r\n                <button \r\n                  type=\"button\" \r\n                  class=\"btn btn-sm btn-outline-secondary border-end-0 rounded-0\"\r\n                >\r\n                  編輯\r\n                </button>\r\n                <button \r\n                  type=\"button\" \r\n                  class=\"btn btn-sm btn-outline-danger rounded-0\" \r\n                >\r\n                  刪除\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CouponModal from '@/components/CouponModal.vue';\r\nimport DeleteProduct from '@/components/DeleteProduct.vue';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      coupons: {},\r\n      tempCoupon: {\r\n        title: '',\r\n        is_enabled: 0,\r\n        // 折扣\r\n        percent: 100,\r\n        code: '',\r\n      },\r\n      isLoading: false,\r\n      isNew: false,\r\n    };\r\n  },\r\n  components: {\r\n    CouponModal,\r\n    DeleteProduct,\r\n  },\r\n  methods: {\r\n    openCouponModal(isNew, item) {\r\n      this.isNew = isNew;\r\n      if(this.isNew) {\r\n        this.tempCoupon = {\r\n          due_data: new Date().getTime() / 1000,\r\n        };\r\n      } else {\r\n        this.tempCoupon = {...item};\r\n      }\r\n      this.$refs.couponMosal.openModal();\r\n    },\r\n    // 取得優惠券\r\n    getCoupons() {\r\n      this.isLoading = true;\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons`\r\n      this.$http.get(api)\r\n      .then((response) => {\r\n        this.coupons = response.data.coupons;\r\n        this.isLoading = false;\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(error.response, '錯誤訊息');\r\n      })\r\n    },\r\n    // 編輯或新增\r\n    updateCoupons(tempCoupon) {\r\n      this.isLoading = true;\r\n      let api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`;\r\n      let apiMethods = 'post';\r\n      // 把 tempCoupon 裡的必填項目代入\r\n      let data = tempCoupon;\r\n\r\n      if(!this.isNew) {\r\n        api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`\r\n        apiMethods = 'put';\r\n        data = this.tempCoupon;\r\n      };\r\n\r\n      this.$http[apiMethods](api, {data})\r\n      .then(() => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(response, '新增優惠券');\r\n        // 這邊想測試看看是不是也可以這麼寫\r\n        const couponComponent = this.$refs.couponModal;\r\n        couponComponent.hideModal();\r\n        this.getCoupons();\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(error.response, '錯誤訊息');\r\n      })\r\n      \r\n    },\r\n    // 刪除優惠券\r\n    delCoupon() {\r\n      this.isLoading = true;\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\r\n      this.$http.delete(api)\r\n      .then((response) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(response, '刪除優惠券')\r\n        const delComponentCoupon = this.$refs.deleteProduct;\r\n        delComponentCoupon.heidModal();\r\n        this.getCoupons();\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(error.response, '錯誤訊息');\r\n      })\r\n    },\r\n  },\r\n  created() {\r\n    this.getCoupons();\r\n  },\r\n}\r\n</script>","<template>\r\n  <div>\r\n    <div \r\n      class=\"modal fade\" \r\n      id=\"couponModal\" \r\n      ref=\"modal\" tabindex=\"-1\" \r\n      aria-labelledby=\"exampleModalLabel\" \r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"exampleModalLabel\">Modal title</h5>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            ...\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n            <button type=\"button\" class=\"btn btn-primary\">Save changes</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport modalMixin from '@/mixins/modalMixin';\r\n\r\nexport default {\r\n  props: {\r\n    coupon: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n    isNew: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      tempCoupon: {},\r\n      due_data: '',\r\n    };\r\n  },\r\n  emits: ['get-coupon'],\r\n  mixins: [modalMixin],\r\n  watch: {\r\n    coupon() {\r\n      this.tempCoupon = this.coupon;\r\n      const couponDate = new date(this.tempCoupon.due_data / 1000)\r\n      \r\n    },\r\n  },\r\n}\r\n</script>","import { render } from \"./CouponModal.vue?vue&type=template&id=9eb09c22\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\html\\\\六角學院\\\\vue-spring\\\\vue-week7\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Coupons.vue?vue&type=template&id=1b4db10c\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\html\\\\六角學院\\\\vue-spring\\\\vue-week7\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}