{"version":3,"sources":["webpack:///./src/views/Article.vue","webpack:///./src/components/ArticleModal.vue","webpack:///./src/components/ArticleModal.vue?b08a","webpack:///./src/views/Article.vue?2b81"],"names":["class","_createElementVNode","width","_createElementBlock","type","onClick","$options","_hoisted_4","_Fragment","_renderList","$data","article","key","id","_toDisplayString","title","author","description","_ctx","date","create_at","isPublic","_hoisted_7","_hoisted_8","_createVNode","_component_ArticleModal","isNew","onGetArticle","ref","_component_DeleteProduct","item","onDelProduct","tabindex","aria-labelledby","aria-hidden","_hoisted_2","_hoisted_3","props","Object","default","Boolean","data","emitter","mixins","modalMixin","__exports__","isLoading","articles","tempArticle","articleData","content","currentPage","inject","components","DeleteProduct","ArticleModal","methods","getArticles","page","this","api","process","$http","get","then","response","pagination","catch","error","console","log","request","message","$emit","style","getArticle","openModal","emit","Date","getTime","tag","$refs","articleModal","updateArticle","apiMethods","status","$httpMessageState","openDelModal","deleteProduct","delArticle","delete","created","render"],"mappings":"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","file":"assets/js/chunk-2d0c4856.c72d5d81.js","sourcesContent":["<template>\r\n  <div>\r\n    <div>\r\n      <!-- <Loading :actuve=\"isLoading\" :z-index=\"1060\"></Loading> -->\r\n      <div class=\"text-end mt-4 mx-5\"> \r\n        <button \r\n          type=\"button\" \r\n          class=\"btn btn-secondary\" \r\n          @click=\"openModal(true)\"\r\n        >\r\n          建立新的頁面\r\n        </button>\r\n      </div>\r\n      <div class=\"px-3\">\r\n        <table class=\"table table-hover mt-4\">\r\n          <thead>\r\n            <tr>\r\n              <th width=\"200\">標題</th>\r\n              <th width=\"200\">作者</th>\r\n              <th>描述</th>\r\n              <th width=\"150\">建立時間</th>\r\n              <th width=\"150\">是否公開</th>\r\n              <th width=\"150\">編輯</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"article in articles\" :key=\"article.id\">\r\n              <td>{{ article.title }}</td>\r\n              <td>{{ article.author }}</td>\r\n              <td>{{ article.description }}</td>\r\n              <td>{{ $filters.date(article.create_at) }}</td>\r\n              <td>\r\n                <span class=\"text-success\" v-if=\"article.isPublic\">已上架</span>\r\n                <span class=\"text-secondary\" v-else>未上架</span>\r\n              </td>\r\n              <td>\r\n                <button \r\n                  type=\"button\" \r\n                  class=\"btn btn-sm btn-outline-secondary border-end-0 rounded-0\"\r\n                  @click=\" getArticle(article.id)\"\r\n                >\r\n                  編輯\r\n                </button>\r\n                <button \r\n                  type=\"button\" \r\n                  class=\"btn btn-sm btn-outline-danger rounded-0\"\r\n                  @click=\"openDelModal(article)\"\r\n                >\r\n                  刪除\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n        <ArticleModal :article=\"tempArticle\" :isNew=\"isNew\" @get-article=\"updateArticle\" ref=\"articleModal\" />\r\n        <DeleteProduct :item=\"tempArticle\" @del-product=\"delArticle\" ref=\"deleteProduct\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DeleteProduct from '@/components/DeleteProduct.vue';\r\nimport ArticleModal from '@/components/ArticleModal.vue';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isLoading: false,\r\n      isNew: false,\r\n      articles: [],\r\n      tempArticle: {},\r\n      articleData: {\r\n        title: '',\r\n        create_at: 0,\r\n        author: '',\r\n        isPublic: true,\r\n        content: '',\r\n      },\r\n      currentPage: 1,\r\n    };\r\n  },\r\n  inject: ['emitter'],\r\n  components: {\r\n    DeleteProduct,\r\n    ArticleModal,\r\n  },\r\n  methods: {\r\n    // 取得文章列表\r\n    getArticles(page = 1) {\r\n      this.currentPage = page\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/articles?page=${page}`;\r\n      this.isLoading = true;\r\n      this.$http.get(api)\r\n      .then((response) => {\r\n        this.isLoading = false;\r\n        this.articles = response.data.articles;\r\n        this.pagination = response.data.pagination;\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        console.log('error', error.response, error.request, error.message);\r\n        this.isLoading = false;\r\n        this.emitter.$emit('push-message', {\r\n          title: '連線錯誤',\r\n          style: 'danger',\r\n          content: error.message,\r\n        });\r\n      })\r\n    },\r\n    // 取得單一文章\r\n    getArticle(id) {\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/article/${id}`;\r\n      this.isLoading = true;\r\n      this.$http.get(api)\r\n      .then((response) => {\r\n        this.openModal(false, response.data.article);\r\n        this.isNew = false;\r\n      })\r\n      .catch((error) => {\r\n        console.log('error', error.response, error.request, error.message);\r\n        this.isLoading = false;\r\n        this.emitter.emit('push-message', {\r\n          title: '連線錯誤',\r\n          style: 'danger',\r\n          content: error.message,\r\n        });\r\n      })\r\n    },\r\n    openModal(isNew, item) {\r\n      if(isNew) {\r\n        this.tempArticle = {\r\n          isPublic: false,\r\n          create_at: new Date().getTime() / 1000,\r\n          tag: [],\r\n        };\r\n        this.isNew = true;\r\n      } else {\r\n        this.tempArticle = { ...item };\r\n        this.isNew = false;\r\n      }\r\n      this.$refs.articleModal.openModal();\r\n    },\r\n    // 辨別新增文章或編輯文章\r\n    updateArticle() {\r\n      this.isLoading = true;\r\n      let api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/article`;\r\n      let apiMethods = 'post';\r\n      let data = this.articleData;\r\n      let status = '新增文章';\r\n\r\n      if(!this.isNew) {\r\n        api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/article/${this.tempArticle.id}`;\r\n        apiMethods = 'put';\r\n        data = this.articleData;\r\n        status = '更新貼文';\r\n      };\r\n\r\n      this.$http[apiMethods](api, { data })\r\n      .then(() => {\r\n        this.isLoading = false,\r\n        this.$httpMessageState(response, status);\r\n        this.$refs.articleModal.openModal();\r\n        this.getArticles(this.currentPage);\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(error.response, '錯誤訊息');\r\n      })\r\n    },\r\n    openDelModal(item) {\r\n      this.tempArticle = {...item};\r\n      this.$refs.deleteProduct.openModal();\r\n    },\r\n    delArticle() {\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/article/${this.tempArticle.id}`;\r\n      this.isLoading = true;\r\n      this.$http.delete(api)\r\n      .then((response) => {\r\n        this.isLoading = false;\r\n        this.$refs.deleteProduct.openModal();\r\n        this.$httpMessageState(response, '刪除成功');\r\n        this.getArticles(this.currentPage);\r\n      })\r\n      .catch((error) => {\r\n        this.isLoading = false;\r\n        this.$httpMessageState(error.response, '刪除貼文');\r\n      })\r\n    },\r\n  },\r\n  created() {\r\n    this.getArticles();\r\n  },\r\n}\r\n</script>\r\n","<template>\r\n  <div>\r\n    <div \r\n      class=\"modal fade\" \r\n      id=\"articleModal\" \r\n      ref=\"modal\" tabindex=\"-1\" \r\n      aria-labelledby=\"exampleModalLabel\" \r\n      aria-hidden=\"true\"\r\n    >\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header bg-dark\">\r\n            <h5 class=\"modal-title text-light\" id=\"exampleModalLabel\">\r\n              <span>新增優惠卷</span>\r\n              <span>編輯貼文</span>\r\n            </h5>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <div class=\"row\">\r\n              <div class=\"col-4\"></div>\r\n\r\n            </div>\r\n\r\n\r\n            \r\n            <div>\r\n              <div class=\"col-12 mb-3\">\r\n                <label for=\"title\" class=\"form-label\">標題</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"title\" placeholder=\"請輸入標題\">\r\n              </div>\r\n              <div class=\"col-12 mb-3\">\r\n                <label for=\"coupon-code\" class=\"form-label\">優惠碼</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"coupon-code\" placeholder=\"請輸入優惠碼\">\r\n              </div>\r\n              <div class=\"col-12 mb-3\">\r\n                <label for=\"due_date\" class=\"form-label\">到期日</label>\r\n                <input type=\"date\" class=\"form-control\" id=\"due_date\">\r\n              </div>\r\n              <div class=\"col-12 mb-3\">\r\n                <label for=\"percent\" class=\"form-label\">折扣百分比</label>\r\n                <input type=\"number\" class=\"form-control\" id=\"percent\" placeholder=\"請輸入折扣百分比\">\r\n              </div>\r\n              <div class=\"form-check\">\r\n                <input \r\n                  class=\"form-check-input\" \r\n                  type=\"checkbox\" \r\n                  id=\"is_enabled\"\r\n                >\r\n                <label class=\"form-check-label\" for=\"is_enabled\">\r\n                  是否啟用\r\n                </label>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn btn-outline-secondary\" data-bs-dismiss=\"modal\">取消</button>\r\n            <button \r\n              type=\"button\" \r\n              class=\"btn btn-secondary\" \r\n            >\r\n              <!-- 如果 isNew 是 true 就新增商品，如果是 false 就更新優惠券 -->\r\n              isNew ? '新增商品': '更新優惠券' \r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport modalMixin from '@/mixins/modalMixin';\r\n\r\nexport default {\r\n  props: {\r\n    article: {\r\n      type: Object,\r\n      default() {\r\n        return {};\r\n      },\r\n    },\r\n    isNew: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  data() {\r\n    \r\n  },\r\n  emitter: ['get-article'],\r\n  mixins: [modalMixin],\r\n}\r\n</script>","import { render } from \"./ArticleModal.vue?vue&type=template&id=01f6a563\"\nimport script from \"./ArticleModal.vue?vue&type=script&lang=js\"\nexport * from \"./ArticleModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\html\\\\六角學院\\\\vue-spring\\\\vue-week7\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Article.vue?vue&type=template&id=7d711ab2\"\nimport script from \"./Article.vue?vue&type=script&lang=js\"\nexport * from \"./Article.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\html\\\\六角學院\\\\vue-spring\\\\vue-week7\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}